# ìš°ë¦¬ ê°€ì¡± ì±„íŒ… (Family Chat Application)

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Node.js](https://img.shields.io/badge/Node.js-20+-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.6-blue.svg)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-18.3-61dafb.svg)](https://react.dev/)

ê°€ì¡± êµ¬ì„±ì›ë“¤ì´ ì‰½ê²Œ ì†Œí†µí•  ìˆ˜ ìˆëŠ” **Apple ìŠ¤íƒ€ì¼ì˜ ì‹¤ì‹œê°„ ì±„íŒ… ì• í”Œë¦¬ì¼€ì´ì…˜**ì…ë‹ˆë‹¤. í• ë¨¸ë‹ˆë¶€í„° ì†ìì†ë…€ê¹Œì§€ ëª¨ë‘ê°€ ì§ê´€ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ì‹¤ì‹œê°„ ë©”ì‹œì§•
- **WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ í†µì‹ **: ë‚®ì€ ì§€ì—°ì‹œê°„ìœ¼ë¡œ ì¦‰ê°ì ì¸ ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ 
- **ìë™ ì¬ì—°ê²°**: ë„¤íŠ¸ì›Œí¬ê°€ ë¶ˆì•ˆì •í•  ë•Œ ìë™ìœ¼ë¡œ ì¬ì—°ê²° (ì§€ìˆ˜ ë°±ì˜¤í”„ ì•Œê³ ë¦¬ì¦˜)
- **í•˜íŠ¸ë¹„íŠ¸ ì‹œìŠ¤í…œ**: 30ì´ˆë§ˆë‹¤ ì„œë²„ì™€ í†µì‹ í•˜ì—¬ ì—°ê²° ìƒíƒœ ìœ ì§€

### ì±„íŒ… ê¸°ëŠ¥
- **ë‹¤ì¤‘ ì±„íŒ…ë°©**: ê°€ì¡± ë‹¨ì²´ë°© + ê°œì¸ 1:1 ë©”ì‹œì§€
- **ë©”ì‹œì§€ ê²€ìƒ‰**: ëŒ€í™” ë‚´ìš©ì—ì„œ ë¹ ë¥´ê²Œ ì›í•˜ëŠ” ë©”ì‹œì§€ ì°¾ê¸°
- **íƒ€ì´í•‘ í‘œì‹œ**: "ê°€ì¡± êµ¬ì„±ì›ì´ ì…ë ¥ ì¤‘..." ìƒíƒœ í‘œì‹œ
- **ì½ìŒ í‘œì‹œ**: âœ“ / âœ“âœ“ ë¡œ ë©”ì‹œì§€ ì½ìŒ ìƒíƒœ í™•ì¸

### ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
- **Apple ë””ìì¸**: ë¯¸ë‹ˆë©€í•˜ê³  ê¹”ë”í•œ UI (íŒŒë€ìƒ‰ accents)
- **ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ**: ì‚¬ìš©ì ì„ íƒì— ë”°ë¥¸ í…Œë§ˆ ì „í™˜
- **ì˜¨ë¼ì¸ ìƒíƒœ í‘œì‹œ**: ê°€ì¡± êµ¬ì„±ì›ì˜ ì ‘ì† ì—¬ë¶€ í•œëˆˆì— í™•ì¸
- **ë°˜ì‘í˜• ë””ìì¸**: ë°ìŠ¤í¬í†±, íƒœë¸”ë¦¿, ëª¨ë°”ì¼ ëª¨ë‘ ìµœì í™”

### ê³ ê¸‰ ê¸°ëŠ¥ (êµ¬í˜„ ì™„ë£Œ)
- **ë©”ì‹œì§€ ìˆ˜ì •/ì‚­ì œ**: ë³´ë‚¸ ë©”ì‹œì§€ ìˆ˜ì • ë° ì‚­ì œ ê°€ëŠ¥
- **ì´ëª¨ì§€ ë°˜ì‘**: ë©”ì‹œì§€ì— ë°˜ì‘ ì¶”ê°€
- **ë©”ì‹œì§€ ê³ ì •**: ì¤‘ìš”í•œ ë©”ì‹œì§€ ìƒë‹¨ ê³ ì •
- **ê·¸ë£¹ ìƒì„±**: íŠ¹ì • êµ¬ì„±ì›ë“¤ë¡œ ìƒˆë¡œìš´ ê·¸ë£¹ ì±„íŒ…ë°© ìƒì„±

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ìš”êµ¬ì‚¬í•­
- Node.js 20 ì´ìƒ
- npm ë˜ëŠ” yarn

### ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/Photometry4040/groupchat.git
cd groupchat

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install
```

### ì‹¤í–‰

**ê°œë°œ ëª¨ë“œ**
```bash
npm run dev
```

ê·¸ ë‹¤ìŒ ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:5000`ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ë©ë‹ˆë‹¤.

**í”„ë¡œë•ì…˜ ë¹Œë“œ**
```bash
npm run build
npm start
```

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
groupchat/
â”œâ”€â”€ client/                      # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ pages/
â”‚       â”‚   â””â”€â”€ chat.tsx        # ë©”ì¸ ì±„íŒ… í˜ì´ì§€
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ chat/
â”‚       â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx        # ë©”ì‹œì§€ ì…ë ¥ì°½
â”‚       â”‚   â”‚   â”œâ”€â”€ ChatHeader.tsx       # ì±„íŒ…ë°© í—¤ë”
â”‚       â”‚   â”‚   â”œâ”€â”€ MessageList.tsx      # ë©”ì‹œì§€ ëª©ë¡
â”‚       â”‚   â”‚   â”œâ”€â”€ ChatMessage.tsx      # ë©”ì‹œì§€ ë²„ë¸”
â”‚       â”‚   â”‚   â”œâ”€â”€ FamilySidebar.tsx    # ê°€ì¡± ëª©ë¡ ì‚¬ì´ë“œë°”
â”‚       â”‚   â”‚   â”œâ”€â”€ SearchMessages.tsx   # ë©”ì‹œì§€ ê²€ìƒ‰
â”‚       â”‚   â”‚   â””â”€â”€ DateSeparator.tsx    # ë‚ ì§œ êµ¬ë¶„ì„ 
â”‚       â”‚   â””â”€â”€ ui/              # shadcn/ui ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ hooks/
â”‚       â”‚   â””â”€â”€ useWebSocket.ts  # WebSocket ì—°ê²° í›…
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â””â”€â”€ queryClient.ts   # React Query ì„¤ì •
â”‚       â””â”€â”€ index.css            # ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ index.ts                 # Express ì„œë²„ ì§„ì…ì 
â”‚   â”œâ”€â”€ routes.ts                # WebSocket & REST API ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ storage.ts               # ë°ì´í„° ì €ì¥ì†Œ (ì¸ë©”ëª¨ë¦¬)
â”‚   â””â”€â”€ auth.ts                  # ì¸ì¦ ê´€ë ¨ ë¡œì§
â”œâ”€â”€ shared/
â”‚   â””â”€â”€ schema.ts                # ê³µìœ  ë°ì´í„° ëª¨ë¸ & Zod ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ vite.config.ts               # Vite ì„¤ì •
â””â”€â”€ tailwind.config.ts           # Tailwind CSS ì„¤ì •
```

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ
- **React 18.3** - UI ë¼ì´ë¸ŒëŸ¬ë¦¬
- **TypeScript** - íƒ€ì… ì•ˆì •ì„±
- **Vite** - ë¹Œë“œ ë„êµ¬
- **TailwindCSS** - ìŠ¤íƒ€ì¼ë§
- **shadcn/ui** - UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **TanStack Query v5** - ì„œë²„ ìƒíƒœ ê´€ë¦¬
- **Wouter** - ë¼ìš°íŒ…
- **Lucide React** - ì•„ì´ì½˜

### ë°±ì—”ë“œ
- **Express.js** - ì›¹ í”„ë ˆì„ì›Œí¬
- **TypeScript** - íƒ€ì… ì•ˆì •ì„±
- **WebSocket (ws)** - ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
- **Zod** - ë°ì´í„° ê²€ì¦
- **In-Memory Storage** - ì„ì‹œ ë°ì´í„° ì €ì¥

## ğŸ”Œ WebSocket í”„ë¡œí† ì½œ

### í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„

```typescript
// ì±„íŒ…ë°© ì§„ì…
{ type: "join_room", payload: { roomId, userId, userName } }

// ë©”ì‹œì§€ ì „ì†¡
{ type: "send_message", payload: { content } }

// ì…ë ¥ ì¤‘ í‘œì‹œ
{ type: "typing", payload: {} }

// ì—°ê²° ìœ ì§€ ì‹ í˜¸
{ type: "ping", payload: {} }
```

### ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸

```typescript
// ì±„íŒ…ë°© ê¸°ì¡´ ë©”ì‹œì§€ ë¡œë“œ
{ type: "room_history", payload: { roomId, messages } }

// ìƒˆ ë©”ì‹œì§€ ìˆ˜ì‹ 
{ type: "new_message", payload: { id, content, senderId, senderName, timestamp, roomId } }

// ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì…ë ¥ ì¤‘
{ type: "user_typing", payload: { userId, userName } }

// ì—°ê²° ìœ ì§€ ì‘ë‹µ
{ type: "pong", payload: {} }
```

## ğŸ” ê¸°ë³¸ ê°€ì¡± êµ¬ì„±ì›

ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ë³¸ ê°€ì¡± êµ¬ì„±ì›ë“¤ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤:

| ID | ì´ë¦„ | ìƒíƒœ |
|---|---|---|
| `group` | ê°€ì¡± ë‹¨ì²´ë°© | ì˜¨ë¼ì¸ |
| `mom` | ì—„ë§ˆ | ì˜¨ë¼ì¸ |
| `dad` | ì•„ë¹  | ì˜¨ë¼ì¸ |
| `brother1` | ì²«ì§¸ | ì˜¨ë¼ì¸ |
| `brother2` | ë‘˜ì§¸ | ì˜¤í”„ë¼ì¸ |
| `sister` | ë§‰ë‚´ | ì˜¨ë¼ì¸ |

## ğŸŒ API ì—”ë“œí¬ì¸íŠ¸

### REST API

```
GET /api/members              # ëª¨ë“  ê°€ì¡± êµ¬ì„±ì› ì¡°íšŒ
GET /api/members/:id          # íŠ¹ì • êµ¬ì„±ì› ì •ë³´ ì¡°íšŒ
GET /api/messages/:roomId     # íŠ¹ì • ì±„íŒ…ë°©ì˜ ë©”ì‹œì§€ ì¡°íšŒ
```

### WebSocket Endpoint

```
ws://localhost:5000/ws        # WebSocket ì—°ê²° ê²½ë¡œ
```

## ğŸš€ WebSocket ì•ˆì •ì„± ê°œì„  ì‚¬í•­

ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ **ê°•í™”ëœ ì¬ì—°ê²° ë¡œì§**ì„ êµ¬í˜„í•˜ì—¬ ë¶ˆì•ˆì •í•œ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œë„ ì•ˆì •ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤:

### 1. ì§€ìˆ˜ ë°±ì˜¤í”„ (Exponential Backoff)
- 1ì´ˆ â†’ 2ì´ˆ â†’ 4ì´ˆ â†’ 8ì´ˆ â†’ ... â†’ ìµœëŒ€ 30ì´ˆ
- ì ì§„ì ìœ¼ë¡œ ì¬ì—°ê²° ëŒ€ê¸° ì‹œê°„ì„ ëŠ˜ë ¤ì„œ ì„œë²„ ë¶€í•˜ ê°ì†Œ

### 2. í•˜íŠ¸ë¹„íŠ¸ ì‹œìŠ¤í…œ (Heartbeat/Ping-Pong)
- 30ì´ˆë§ˆë‹¤ ping ì‹ í˜¸ ì „ì†¡
- ì„œë²„ê°€ pongìœ¼ë¡œ ì‘ë‹µí•˜ì—¬ ì—°ê²° ìƒíƒœ í™•ì¸
- ìœ íœ´ ì—°ê²° ìë™ ì¢…ë£Œ ë°©ì§€

### 3. ìë™ ì¬ì—°ê²°
- ë„¤íŠ¸ì›Œí¬ ëŠê¹€ ê°ì§€ ì‹œ ìë™ ì¬ì—°ê²° ì‹œë„
- ìµœëŒ€ 10íšŒê¹Œì§€ ì¬ì‹œë„ (ì•½ 17ë¶„ ë™ì•ˆ ì‹œë„)
- ìŠ¤ë§ˆíŠ¸ ìƒíƒœ ê´€ë¦¬ë¡œ ì¤‘ë³µ ì¬ì—°ê²° ë°©ì§€

### 4. ìƒì„¸í•œ ë¡œê¹…
```
Connecting to WebSocket (attempt 1)...
WebSocket connected successfully
Reconnecting in 2000ms (attempt 2/10)...
```

## ğŸ“± ë°ì´í„° ëª¨ë¸

### FamilyMember
```typescript
{
  id: string;           // ê³ ìœ  ID
  name: string;         // ì´ë¦„
  avatar?: string;      // í”„ë¡œí•„ ì´ë¯¸ì§€ URL
  isOnline: boolean;    // ì˜¨ë¼ì¸ ì—¬ë¶€
  lastMessage?: string; // ë§ˆì§€ë§‰ ë©”ì‹œì§€
}
```

### Message
```typescript
{
  id: string;           // ê³ ìœ  ë©”ì‹œì§€ ID
  content: string;      // ë©”ì‹œì§€ ë‚´ìš©
  senderId: string;     // ë°œì‹ ì ID
  senderName: string;   // ë°œì‹ ì ì´ë¦„
  senderAvatar?: string;// ë°œì‹ ì í”„ë¡œí•„ ì´ë¯¸ì§€
  roomId: string;       // ì±„íŒ…ë°© ID
  timestamp: Date;      // ì „ì†¡ ì‹œê°„
  isEdited?: boolean;   // ìˆ˜ì • ì—¬ë¶€
  editedAt?: Date;      // ìˆ˜ì • ì‹œê°„
  isDeleted?: boolean;  // ì‚­ì œ ì—¬ë¶€
  reactions?: Record<string, string[]>; // ë°˜ì‘ (ì´ëª¨ì§€)
  isPinned?: boolean;   // ê³ ì • ì—¬ë¶€
}
```

## ğŸ¨ ë””ìì¸ íŠ¹ì§•

- **Apple ë¯¸ë‹ˆë©€ë¦¬ì¦˜**: ê¹”ë”í•˜ê³  ì§ê´€ì ì¸ ì¸í„°í˜ì´ìŠ¤
- **ìƒ‰ìƒ íŒ”ë ˆíŠ¸**:
  - Primary: `hsl(211 100% 50%)` (íŒŒë€ìƒ‰)
  - ì¤‘ë¦½ í†¤: íšŒìƒ‰ ìŠ¤ì¼€ì¼
- **íƒ€ì´í¬ê·¸ë˜í”¼**: ì‹œìŠ¤í…œ í°íŠ¸ ìŠ¤íƒ (SF Pro Display, -apple-system)
- **ê°„ê²©**: ì¼ê´€ëœ 8px ê¸°ë³¸ ê°„ê²© ì‹œìŠ¤í…œ
- **ì• ë‹ˆë©”ì´ì…˜**: Framer Motionì„ ì‚¬ìš©í•œ ë¶€ë“œëŸ¬ìš´ ì „í™˜

## ğŸ”„ ìƒíƒœ ê´€ë¦¬

### í´ë¼ì´ì–¸íŠ¸
- **TanStack Query (React Query)**: ì„œë²„ ìƒíƒœ ê´€ë¦¬ ë° ìºì‹±
- **React Local State**: UI ìƒíƒœ ê´€ë¦¬ (selectedMemberId, searchQuery ë“±)
- **Custom Hook (useWebSocket)**: WebSocket ì—°ê²° ìƒíƒœ

### ì„œë²„
- **In-Memory Maps**: ë©”ì‹œì§€ ë° ì‚¬ìš©ì ë°ì´í„° ì €ì¥
- **Connected Clients Map**: í™œì„± WebSocket ì—°ê²° ì¶”ì 

## ğŸ“š ì£¼ìš” Hook ë° ìœ í‹¸

### useWebSocket
```typescript
const { isConnected, sendMessage, sendTyping } = useWebSocket({
  userId: "me",
  userName: "ë‚˜",
  roomId: "group",
  onMessage: handleNewMessage,
  onRoomHistory: handleRoomHistory,
  onTyping: handleTyping,
});
```

- **ìë™ ì¬ì—°ê²°**: ì—°ê²° ëŠê¹€ ì‹œ ìë™ìœ¼ë¡œ ì¬ì—°ê²°
- **ë©”ì‹œì§€ ì „ì†¡**: `sendMessage(content)`
- **íƒ€ì´í•‘ í‘œì‹œ**: `sendTyping()`

## ğŸ§ª í…ŒìŠ¤íŠ¸

í˜„ì¬ëŠ” ìˆ˜ë™ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ê¸°ëŠ¥ì„ ê²€ì¦í•©ë‹ˆë‹¤:

1. ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ 
2. ë‹¤ì¤‘ ì±„íŒ…ë°© ì „í™˜
3. ë©”ì‹œì§€ ê²€ìƒ‰
4. íƒ€ì´í•‘ í‘œì‹œ
5. ì˜¨ë¼ì¸ ìƒíƒœ ë³€ê²½
6. ë„¤íŠ¸ì›Œí¬ ì¬ì—°ê²°

## ğŸ“¦ ë¹Œë“œ ë° ë°°í¬

### ê°œë°œ ë¹Œë“œ
```bash
npm run dev
```

### í”„ë¡œë•ì…˜ ë¹Œë“œ
```bash
npm run build
npm start
```

### íƒ€ì… ì²´í¬
```bash
npm run check
```

## ğŸ¯ í–¥í›„ ê³„íš

- [ ] ë°ì´í„°ë² ì´ìŠ¤ í†µí•© (PostgreSQL)
- [ ] ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ
- [ ] íŒŒì¼/ì´ë¯¸ì§€ ê³µìœ 
- [ ] ìŒì„±/ì˜ìƒ í†µí™”
- [ ] ë©”ì‹œì§€ ì•”í˜¸í™”
- [ ] í‘¸ì‹œ ì•Œë¦¼
- [ ] ëª¨ë°”ì¼ ì•± (React Native)

## ğŸ“„ ë¼ì´ì„¼ìŠ¤

MIT License - ììœ ë¡­ê²Œ ì‚¬ìš©, ìˆ˜ì •, ë°°í¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.

## ğŸ‘¨â€ğŸ’» ê¸°ì—¬

ì´ í”„ë¡œì íŠ¸ì— ê¸°ì—¬í•˜ê³  ì‹¶ë‹¤ë©´:

1. Fork í•˜ê¸°
2. Feature ë¸Œëœì¹˜ ìƒì„± (`git checkout -b feature/amazing-feature`)
3. ë³€ê²½ì‚¬í•­ ì»¤ë°‹ (`git commit -m 'Add amazing feature'`)
4. ë¸Œëœì¹˜ì— Push (`git push origin feature/amazing-feature`)
5. Pull Request ìƒì„±

## ğŸ“§ ë¬¸ì˜

ì§ˆë¬¸ì´ë‚˜ í”¼ë“œë°±ì´ ìˆë‹¤ë©´ GitHub Issuesë¥¼ í†µí•´ ì—°ë½í•´ì£¼ì„¸ìš”.

---

**Made with â¤ï¸ for family communication**
